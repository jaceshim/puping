<head>
	<title>카테고리 목록</title>
	<link rel="stylesheet" href="/assets/js/jstree/themes/default/style.min.css" />
	<script src="/assets/js/jstree/jstree.min.js"></script>
	<script type="text/javascript">
		var URI_PREFIX = '/rear/category/';
		var DETAIL_CONTENT_AREA = 'dev-detail-content';
		
		function jsInsert(obj) {
			var titleText = obj.text + ' 하위 카테고리 등록';
			detailTitleHandler(titleText);
			
			jQuery.ajax({
				url: URI_PREFIX + 'insertform.ajax',
				data: {pcateSeq: obj.id},
				success: function(result) {
					detailContentHandler(result);
				}
			});
		}
		
		function jsUpdate(obj) {
			var titleText = obj.text + ' - 수정 ';
			detailTitleHandler(titleText);
			
			jQuery.ajax({
				url: URI_PREFIX + 'updateform.ajax',
				data: {cateSeq: obj.id},
				success: function(result) {
					detailContentHandler(result);
				}
			});
					
		}
		
		function jsView(obj) {
			var titleText = obj.text + ' - 상세정보';
			detailTitleHandler(titleText);
			
			jQuery.ajax({
				url: URI_PREFIX + 'view.ajax',
				data: {cateSeq: obj.id},
				success: function(result) {
					detailContentHandler(result);
				}
			});			
		}
		
		function detailTitleHandler(txt) {
			$('#dev-detail-title').text(txt);
		}
		
		function detailContentHandler(html) {
			$('#dev-detail-content').html(html);
		}
		
		$(function () {
			$('#dev-cate-tree').jstree({
				'core' : {
					'animation' : 0,
					'check_callback' : true,
					'themes' : { 'stripes' : true },
					'data' : {
						'url' : function (node) {
							return URI_PREFIX + 'tree.json';
						},
						'data' : function (node) {
							var tempNodeId = node.cateSeq === '#' ? '0' : node.cateSeq;
							return { 'pcateSeq' : tempNodeId};
						}
					}
				},
				'types' : {
					'#' : {
						'max_children' : 1, 
						'max_depth' : 4, 
						'valid_children' : ['root']
					},
					'root' : {
						'icon' : '/assets/js/jstree/images/tree_icon.png',
						'valid_children' : ['default']
					},
					'default' : {
						'valid_children' : ['default','file']
					},
					'file' : {
						'icon' : 'glyphicon glyphicon-file',
						'valid_children' : []
					}
				},				
				'plugins' : ['contextmenu', 'state', 'types', 'wholerow'],
				'contextmenu' : {
					'items': function($node) {
						return {
							'insert': {
								'label' : '등록',
								'action' : function() {
									console.log($node);
									jsInsert($node);
								}
							},
							'update': {
								'label' : '수정',
								'action' : function() {
									jsUpdate($node);
								}
							},
							'view' : {
								'label' : '상세조회',
								'action' : function() {
									jsView($node);
								}
							}
						}
					}
				}
			});		
		});
	</script>
</head>
<body>

<div class="span12">
	<!--PAGE CONTENT BEGINS-->

	<div class="row-fluid">
		<div class="widget-box span5">
			<div class="widget-header header-color-blue2">
				<h4 class="lighter smaller">카테고리</h4>
			</div>

			<div class="widget-body">
				<div class="widget-main padding-8">
					<div id="dev-cate-tree"></div>
				</div>
			</div>
		</div>

		<div class="widget-box span7">
			<div class="widget-header header-color-green2">
				<h4 class="lighter smaller" id="dev-detail-title">상세정보</h4>
			</div>

			<div class="widget-body">
				<div class="widget-main padding-8">
					<div id="dev-detail-content">
						&nbsp;
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--PAGE CONTENT ENDS-->
</div>

</body>




	